NAME=logrotate
VERSION=3.7
ARCH=i686
RELEASE=2
URL="http://ftp.debian.org/debian/pool/main/l/logrotate/"
DESC="Rotates, compresses, and mails the system logs."
GROUP=base
LICENSE=GPLv2
SIZE="34K"

SOURCES="http://ftp.debian.org/debian/pool/main/l/logrotate/logrotate_3.7.orig.tar.gz
         http://ftp.debian.org/debian/pool/main/l/logrotate/logrotate_3.7-2.diff.gz
         logrotate_decebal.diff logrotate.cron logrotate.conf"

RUNTIME="popt"

build() {
  cd $SRC/$NAME-$VERSION
  
  patch -p1 < ../logrotate_3.7-2.diff
  patch -p0 < ../logrotate_decebal.diff
  
  # put our clfags here
  sed -i "s:CFLAGS = -Wall -D_GNU_SOURCE:CFLAGS = -Wall -D_GNU_SOURCE $CFLAGS:" Makefile
  
  make
  
  install -D -m 0755 logrotate $PKG/usr/sbin/logrotate
  install -D -m 0644 logrotate.8 $PKG/usr/share/man/man8/logrotate.8
  install -D -m 0644 ../logrotate.conf $PKG/etc/logrotate.conf
  install -D -m 0755 ../logrotate.cron $PKG/etc/cron.d/daily/logrotate
  
  mkdir -p $PKG/etc/logrotate.d $PKG/var/lib/logrotate
  
  install_docs CHANGES COPYING README.HPUX README.Solaris
}
