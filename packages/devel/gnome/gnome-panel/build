NAME=gnome-panel
VERSION=2.10.0
ARCH=i686
RELEASE=1
URL="http://gnome.org/"
DESC="The GNOME panel."
GROUP=gnome
LICENSE="GPLv2 LGPLv2.1 FDLv1.1"
SIZE="3012K"
HUSE="gtkdoc static"

SOURCES="ftp://ftp.gnome.org/pub/gnome/desktop/2.10/2.10.0/sources/gnome-panel-2.10.0.tar.bz2
         decebal-layout.diff gnome-panelrc"

BUILDTIME="intltool"

RUNTIME="gnome-desktop gnome-menus evolution-data-server libwnck"

use gtkdoc && BUILDTIME="$BUILDTIME gtk-doc"

build() {
  cd $SRC/$NAME-$VERSION
  
  find . -name Makefile.in -exec sed -i -e 's/-scrollkeeper-update.*//' {} \;
  if [ -f omf.make ]; then
    sed -i -e 's/-scrollkeeper-update.*//' omf.make
  fi
  
  use static || OPTS="--disable-static"
  use gtkdoc && OPTS="$OPTS --enable-gtk-doc"
      
  ./configure --prefix=/opt/gnome \
              --sysconfdir=/etc/opt/gnome \
	      --mandir=/opt/gnome/share/man \
	      --libexecdir=/opt/gnome/lib/applets \
	      --localstatedir=/var/lib $OPTS
  make
  make DESTDIR=$PKG install
  
  rm -f $PKG/opt/gnome/share/gnome-panelrc
  install -m 0644 ../gnome-panelrc $PKG/opt/gnome/share/gnome-panelrc
  
  install_docs AUTHORS COPYING* ChangeLog INSTALL HACKING \
    NEWS README
}
